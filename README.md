# OSVC (Open source voice changer)
## 概要
RubberBand (ライブラリ) を用いてリアルタイムに低遅延なボイチェンをしたいソフト  

## 機能
```
--help                      ヘルプを表示します。  
--list-devices              音声の入出力デバイスを表示します。  
--chunklength [len: int]    処理単位をサンプル数で指定します。  
--rblength [len: int]       バッファの大きさを指定します。  
                            大きくすると音声が途切れにくくなりますが、遅延が大きくなります。  
--input-device [idx: int]   入力デバイスを指定します。  
                            (--list-devicesで表示された番号による)  
--output-device [idx: int]  出力デバイスを指定します。  
                            (--list-devicesで表示された番号による)  
--fsample [fs: float]       サンプリング周波数を指定します。  
--init-pitch                ピッチの初期値を指定します。  
--init-formant              フォルマント移動量の初期値を指定します。  
--mono                      出力をモノラル化します。  
                            左右で位相がずれてしまい違和感が生じる場合、力技で直します。  
--ll                        遅延を減らします。  
                            ただし若干品質が下がります。  
--thru                      音声に何も加工せずそのまま横流しします。  
                            (よってボイチェンとしては機能しません。)  
--tr-mix                    音楽的な周波数の範囲外を基準として、波形の位相を波形の立ち上がりに合わせます。  
--tr-smooth                 位相を操作しないようにします。  
--smoothing                 時系列でのスムージングを有効にします。  
--ch-together               左右チャンネル間での位相の差を最小限に抑えます。  
--tx-stream                 ネットワーク経由での音声出力を有効にします。  
--tx-stream-dest-addr       ネットワーク経由で音声出力する際の出力先アドレスを指定します  
--tx-stream-dest-port       ネットワーク経由で音声出力する際の出力先ポートを指定します  
--rx-stream                 ネットワーク経由での音声入力を有効にします。  
--rx-stream-dest-addr       ネットワーク経由で音声入力する際の待ち受けアドレスを指定します  
--rx-stream-dest-port       ネットワーク経由で音声入力する際の待ち受けポートを指定します  
--no-local-out              音声デバイスからの出力を無効にします。  
--no-local-in               音声デバイスからの入力を無効にします。  
--show-buffer-health             バッファの状態と入出力レベルをバーで表示します。  
--barlength [len: int]           バー表示の長さを指定します。  
--show-interval [interval: int]  表示の更新間隔を指定します。(厳密なものではありません。)  
--enable-prompt                  OSVC本体からパラメータを操作できるようにします  
```
  
ネットワーク経由の音声入出力について、引数で明示的に有効にしない限り有効になりません。  
また音声入力について、現状ではPCの音声デバイスからの入力を有効にしている時にそちらが優先され、ネットワークから受信したデータは無視されます。  

## ビルド・依存ライブラリについて
このソフトはPortAudioとRubberBandに依存しています。  
ビルド前に各ライブラリの開発用ファイルをインストールしてください。  
( 例: `librubberband-dev`, `portaudio19-dev` )  
また、ビルドにはCMakeを利用しています。  

## 現状
Linux上で遅延は60msぐらいになっています。  
Windowsでの遅延もWASAPIを使えばそれくらいに収まります。  
（相応のスペックで動作するコンピュータであれば遅延は40msぐらいまで抑えられると思います。  
パススルーの場合、環境によっては20msを切ることも可能です。）  
  
ただしリサンプリング機能が無いので、WASAPIで使う場合は入出力のサンプリング周波数をOSの設定から合わせてください。  
また、ネットワークで音声を送受信する際も、双方でサンプリング周波数を合わせてください。  
  
加えて、ネットワーク周りについては、Linux以外正常に動作しません。  
現在の状況は以下の通りです。  
* macOS
    * UDPによる音声の受信はできません。送信は可能です。
    * remoconはローカルホストでのみ動作します。
* Windowsでは未検証です。（恐らく動作しません。）
